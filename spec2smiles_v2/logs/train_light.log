============================================================
Training Part A (Spectrum -> Descriptors)
============================================================
Model:   Hybrid CNN-Transformer
Dataset: gnps
Device:  cuda

Loading and preprocessing raw data...
Loaded 23481/23630 valid samples
Calculating 205 descriptors in parallel...
Calculating descriptors (24 workers):   0%|          | 0/23481 [00:00<?, ?it/s]Calculating descriptors (24 workers):   0%|          | 1/23481 [00:12<84:18:29, 12.93s/it]Calculating descriptors (24 workers):   3%|▎         | 601/23481 [00:25<13:49, 27.58it/s] Calculating descriptors (24 workers):   3%|▎         | 601/23481 [00:39<13:49, 27.58it/s]Calculating descriptors (24 workers):  20%|█▉        | 4601/23481 [00:43<02:22, 132.08it/s]Calculating descriptors (24 workers):  51%|█████     | 11901/23481 [00:45<00:27, 414.11it/s]Calculating descriptors (24 workers):  53%|█████▎    | 12338/23481 [00:48<00:29, 383.98it/s]Calculating descriptors (24 workers):  60%|█████▉    | 14001/23481 [00:51<00:22, 412.93it/s]Calculating descriptors (24 workers):  60%|██████    | 14130/23481 [00:51<00:23, 406.53it/s]Calculating descriptors (24 workers):  63%|██████▎   | 14801/23481 [00:53<00:21, 407.59it/s]Calculating descriptors (24 workers):  63%|██████▎   | 14901/23481 [00:56<00:30, 279.16it/s]Calculating descriptors (24 workers):  65%|██████▍   | 15201/23481 [01:00<00:37, 221.20it/s]Calculating descriptors (24 workers):  69%|██████▉   | 16301/23481 [01:00<00:21, 341.28it/s]Calculating descriptors (24 workers):  71%|███████   | 16701/23481 [01:02<00:21, 313.48it/s]Calculating descriptors (24 workers):  73%|███████▎  | 17201/23481 [01:05<00:25, 249.17it/s]Calculating descriptors (24 workers):  76%|███████▌  | 17901/23481 [01:16<00:42, 132.51it/s]Calculating descriptors (24 workers):  98%|█████████▊| 23101/23481 [01:18<00:00, 487.59it/s]Calculating descriptors (24 workers): 100%|██████████| 23481/23481 [01:18<00:00, 298.19it/s]
Processing spectra:   0%|          | 0/23481 [00:00<?, ?it/s]Processing spectra:   1%|          | 191/23481 [00:00<00:12, 1883.44it/s]Processing spectra:   2%|▏         | 380/23481 [00:00<00:21, 1084.68it/s]Processing spectra:   2%|▏         | 507/23481 [00:00<00:20, 1105.02it/s]Processing spectra:   7%|▋         | 1697/23481 [00:00<00:04, 4440.88it/s]Processing spectra:  12%|█▏        | 2714/23481 [00:00<00:03, 6189.35it/s]Processing spectra:  15%|█▍        | 3427/23481 [00:00<00:03, 5772.00it/s]Processing spectra:  17%|█▋        | 4071/23481 [00:01<00:04, 4224.91it/s]Processing spectra:  20%|█▉        | 4590/23481 [00:01<00:09, 2014.30it/s]Processing spectra:  21%|██        | 4969/23481 [00:01<00:09, 2033.37it/s]Processing spectra:  23%|██▎       | 5296/23481 [00:02<00:09, 1924.87it/s]Processing spectra:  24%|██▎       | 5571/23481 [00:02<00:10, 1757.11it/s]Processing spectra:  25%|██▍       | 5802/23481 [00:02<00:10, 1681.27it/s]Processing spectra:  26%|██▌       | 6006/23481 [00:02<00:10, 1606.76it/s]Processing spectra:  27%|██▋       | 6257/23481 [00:02<00:09, 1769.75it/s]Processing spectra:  28%|██▊       | 6560/23481 [00:02<00:08, 2027.90it/s]Processing spectra:  29%|██▉       | 6800/23481 [00:02<00:07, 2111.41it/s]Processing spectra:  30%|██▉       | 7036/23481 [00:03<00:16, 989.29it/s] Processing spectra:  31%|███       | 7286/23481 [00:03<00:13, 1190.43it/s]Processing spectra:  32%|███▏      | 7575/23481 [00:03<00:10, 1467.61it/s]Processing spectra:  33%|███▎      | 7799/23481 [00:03<00:13, 1142.10it/s]Processing spectra:  34%|███▍      | 7977/23481 [00:04<00:18, 820.55it/s] Processing spectra:  35%|███▍      | 8136/23481 [00:04<00:16, 921.23it/s]Processing spectra:  36%|███▌      | 8397/23481 [00:04<00:12, 1187.51it/s]Processing spectra:  37%|███▋      | 8576/23481 [00:04<00:14, 1013.54it/s]Processing spectra:  37%|███▋      | 8723/23481 [00:04<00:13, 1055.13it/s]Processing spectra:  38%|███▊      | 8908/23481 [00:05<00:12, 1205.59it/s]Processing spectra:  39%|███▊      | 9075/23481 [00:05<00:11, 1303.66it/s]Processing spectra:  39%|███▉      | 9253/23481 [00:05<00:10, 1414.88it/s]Processing spectra:  40%|████      | 9482/23481 [00:05<00:08, 1633.15it/s]Processing spectra:  42%|████▏     | 9756/23481 [00:05<00:07, 1921.62it/s]Processing spectra:  42%|████▏     | 9966/23481 [00:05<00:06, 1964.41it/s]Processing spectra:  43%|████▎     | 10198/23481 [00:05<00:06, 2060.60it/s]Processing spectra:  44%|████▍     | 10414/23481 [00:05<00:06, 2062.67it/s]Processing spectra:  45%|████▌     | 10641/23481 [00:05<00:06, 2119.80it/s]Processing spectra:  46%|████▋     | 10883/23481 [00:05<00:05, 2200.43it/s]Processing spectra:  47%|████▋     | 11107/23481 [00:06<00:05, 2093.65it/s]Processing spectra:  48%|████▊     | 11332/23481 [00:06<00:05, 2137.71it/s]Processing spectra:  49%|████▉     | 11549/23481 [00:06<00:05, 2101.33it/s]Processing spectra:  50%|█████     | 11764/23481 [00:06<00:05, 2114.51it/s]Processing spectra:  51%|█████     | 12027/23481 [00:06<00:05, 2261.86it/s]Processing spectra:  53%|█████▎    | 12349/23481 [00:06<00:04, 2541.78it/s]Processing spectra:  54%|█████▍    | 12716/23481 [00:06<00:03, 2862.17it/s]Processing spectra:  56%|█████▌    | 13112/23481 [00:06<00:03, 3185.97it/s]Processing spectra:  57%|█████▋    | 13491/23481 [00:06<00:02, 3354.88it/s]Processing spectra:  59%|█████▉    | 13885/23481 [00:07<00:02, 3528.19it/s]Processing spectra:  61%|██████    | 14278/23481 [00:07<00:02, 3629.37it/s]Processing spectra:  63%|██████▎   | 14684/23481 [00:07<00:02, 3754.24it/s]Processing spectra:  64%|██████▍   | 15100/23481 [00:07<00:02, 3869.94it/s]Processing spectra:  67%|██████▋   | 15742/23481 [00:07<00:01, 4630.68it/s]Processing spectra:  70%|███████   | 16437/23481 [00:07<00:01, 5323.49it/s]Processing spectra:  73%|███████▎  | 17178/23481 [00:07<00:01, 5947.61it/s]Processing spectra:  76%|███████▌  | 17774/23481 [00:07<00:01, 5628.34it/s]Processing spectra:  78%|███████▊  | 18341/23481 [00:08<00:02, 2287.88it/s]Processing spectra:  80%|███████▉  | 18766/23481 [00:09<00:03, 1296.37it/s]Processing spectra:  81%|████████▏ | 19080/23481 [00:09<00:04, 899.18it/s] Processing spectra:  82%|████████▏ | 19312/23481 [00:10<00:05, 746.21it/s]Processing spectra:  83%|████████▎ | 19487/23481 [00:10<00:06, 643.65it/s]Processing spectra:  84%|████████▎ | 19621/23481 [00:11<00:06, 603.70it/s]Processing spectra:  84%|████████▍ | 19728/23481 [00:11<00:06, 583.36it/s]Processing spectra:  84%|████████▍ | 19818/23481 [00:11<00:06, 569.23it/s]Processing spectra:  85%|████████▍ | 19896/23481 [00:11<00:06, 556.53it/s]Processing spectra:  85%|████████▌ | 19966/23481 [00:11<00:06, 561.48it/s]Processing spectra:  85%|████████▌ | 20032/23481 [00:12<00:06, 557.12it/s]Processing spectra:  86%|████████▌ | 20099/23481 [00:12<00:05, 575.41it/s]Processing spectra:  87%|████████▋ | 20402/23481 [00:12<00:02, 1070.20it/s]Processing spectra:  87%|████████▋ | 20535/23481 [00:12<00:03, 899.87it/s] Processing spectra:  88%|████████▊ | 20647/23481 [00:12<00:03, 861.61it/s]Processing spectra:  88%|████████▊ | 20749/23481 [00:12<00:03, 774.88it/s]Processing spectra:  89%|████████▊ | 20838/23481 [00:12<00:03, 773.16it/s]Processing spectra:  89%|████████▉ | 20923/23481 [00:13<00:03, 782.23it/s]Processing spectra:  89%|████████▉ | 21007/23481 [00:13<00:03, 776.68it/s]Processing spectra:  90%|████████▉ | 21089/23481 [00:13<00:03, 695.48it/s]Processing spectra:  90%|█████████ | 21163/23481 [00:13<00:03, 651.96it/s]Processing spectra:  90%|█████████ | 21231/23481 [00:13<00:03, 643.46it/s]Processing spectra:  91%|█████████ | 21308/23481 [00:13<00:03, 672.71it/s]Processing spectra:  91%|█████████ | 21379/23481 [00:13<00:03, 681.63it/s]Processing spectra:  91%|█████████▏| 21453/23481 [00:13<00:02, 696.43it/s]Processing spectra:  92%|█████████▏| 21526/23481 [00:13<00:02, 705.80it/s]Processing spectra:  92%|█████████▏| 21620/23481 [00:14<00:02, 769.12it/s]Processing spectra:  93%|█████████▎| 21760/23481 [00:14<00:01, 950.75it/s]Processing spectra:  93%|█████████▎| 21944/23481 [00:14<00:01, 1209.54it/s]Processing spectra:  94%|█████████▍| 22067/23481 [00:14<00:01, 821.68it/s] Processing spectra:  94%|█████████▍| 22186/23481 [00:14<00:01, 902.75it/s]Processing spectra:  95%|█████████▌| 22334/23481 [00:14<00:01, 1040.71it/s]Processing spectra:  96%|█████████▌| 22543/23481 [00:14<00:00, 1308.41it/s]Processing spectra:  97%|█████████▋| 22689/23481 [00:14<00:00, 1086.69it/s]Processing spectra:  97%|█████████▋| 22814/23481 [00:15<00:00, 935.94it/s] Processing spectra:  98%|█████████▊| 22922/23481 [00:15<00:00, 950.15it/s]Processing spectra:  99%|█████████▊| 23172/23481 [00:15<00:00, 1310.71it/s]Processing spectra: 100%|██████████| 23481/23481 [00:15<00:00, 1521.52it/s]
/root/.cache/pypoetry/virtualenvs/spec2smiles-pipeline-XhsybQeG-py3.10/lib/python3.10/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
