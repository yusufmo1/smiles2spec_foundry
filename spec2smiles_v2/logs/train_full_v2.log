============================================================
Training Part A (Spectrum -> Descriptors)
============================================================
Model:   Hybrid CNN-Transformer
Dataset: gnps
Device:  cuda

Loading and preprocessing raw data...
Loaded 23481/23630 valid samples
Calculating 205 descriptors in parallel...
Calculating descriptors (24 workers):   0%|          | 0/23481 [00:00<?, ?it/s]Calculating descriptors (24 workers):   0%|          | 1/23481 [00:09<60:23:58,  9.26s/it]Calculating descriptors (24 workers):   3%|▎         | 601/23481 [00:19<10:33, 36.12it/s] Calculating descriptors (24 workers):  19%|█▉        | 4501/23481 [00:22<01:05, 291.77it/s]Calculating descriptors (24 workers):  19%|█▉        | 4501/23481 [00:39<01:05, 291.77it/s]Calculating descriptors (24 workers):  20%|█▉        | 4601/23481 [00:44<03:12, 97.87it/s] Calculating descriptors (24 workers):  52%|█████▏    | 12301/23481 [00:45<00:26, 422.72it/s]Calculating descriptors (24 workers):  56%|█████▌    | 13101/23481 [00:45<00:22, 464.42it/s]Calculating descriptors (24 workers):  58%|█████▊    | 13701/23481 [00:49<00:25, 389.88it/s]Calculating descriptors (24 workers):  63%|██████▎   | 14901/23481 [00:55<00:27, 309.80it/s]Calculating descriptors (24 workers):  66%|██████▋   | 15601/23481 [00:56<00:22, 343.34it/s]Calculating descriptors (24 workers):  70%|██████▉   | 16401/23481 [00:57<00:17, 410.55it/s]Calculating descriptors (24 workers):  71%|███████   | 16701/23481 [00:57<00:16, 420.26it/s]Calculating descriptors (24 workers):  73%|███████▎  | 17201/23481 [01:02<00:23, 272.47it/s]Calculating descriptors (24 workers):  74%|███████▎  | 17301/23481 [01:02<00:21, 282.51it/s]Calculating descriptors (24 workers):  76%|███████▌  | 17901/23481 [01:11<00:40, 137.77it/s]Calculating descriptors (24 workers):  98%|█████████▊| 23101/23481 [01:13<00:00, 582.26it/s]Calculating descriptors (24 workers): 100%|██████████| 23481/23481 [01:13<00:00, 320.96it/s]
Processing spectra:   0%|          | 0/23481 [00:00<?, ?it/s]Processing spectra:   1%|          | 179/23481 [00:00<00:13, 1772.37it/s]Processing spectra:   2%|▏         | 357/23481 [00:00<00:24, 962.35it/s] Processing spectra:   2%|▏         | 473/23481 [00:00<00:25, 885.22it/s]Processing spectra:   6%|▌         | 1379/23481 [00:00<00:06, 3157.44it/s]Processing spectra:  11%|█         | 2579/23481 [00:00<00:03, 5670.34it/s]Processing spectra:  14%|█▍        | 3279/23481 [00:00<00:03, 5288.38it/s]Processing spectra:  17%|█▋        | 3899/23481 [00:01<00:05, 3668.89it/s]Processing spectra:  19%|█▊        | 4386/23481 [00:01<00:06, 2976.91it/s]Processing spectra:  20%|██        | 4779/23481 [00:02<00:11, 1644.68it/s]Processing spectra:  22%|██▏       | 5069/23481 [00:02<00:11, 1613.43it/s]Processing spectra:  23%|██▎       | 5316/23481 [00:02<00:11, 1528.91it/s]Processing spectra:  24%|██▎       | 5526/23481 [00:02<00:12, 1402.47it/s]Processing spectra:  24%|██▍       | 5703/23481 [00:02<00:13, 1345.82it/s]Processing spectra:  25%|██▍       | 5861/23481 [00:02<00:13, 1296.08it/s]Processing spectra:  26%|██▌       | 6005/23481 [00:03<00:14, 1223.64it/s]Processing spectra:  26%|██▋       | 6220/23481 [00:03<00:12, 1402.42it/s]Processing spectra:  28%|██▊       | 6470/23481 [00:03<00:10, 1639.10it/s]Processing spectra:  29%|██▊       | 6728/23481 [00:03<00:09, 1860.87it/s]Processing spectra:  30%|██▉       | 6935/23481 [00:04<00:21, 770.66it/s] Processing spectra:  31%|███       | 7281/23481 [00:04<00:14, 1109.99it/s]Processing spectra:  32%|███▏      | 7492/23481 [00:04<00:12, 1249.78it/s]Processing spectra:  33%|███▎      | 7700/23481 [00:04<00:11, 1395.46it/s]Processing spectra:  34%|███▎      | 7907/23481 [00:04<00:19, 794.56it/s] Processing spectra:  34%|███▍      | 8063/23481 [00:05<00:19, 780.41it/s]Processing spectra:  35%|███▌      | 8262/23481 [00:05<00:16, 949.05it/s]Processing spectra:  36%|███▌      | 8414/23481 [00:05<00:14, 1018.02it/s]Processing spectra:  36%|███▋      | 8560/23481 [00:05<00:16, 880.59it/s] Processing spectra:  37%|███▋      | 8683/23481 [00:05<00:15, 941.98it/s]Processing spectra:  38%|███▊      | 8868/23481 [00:05<00:13, 1113.36it/s]Processing spectra:  38%|███▊      | 9006/23481 [00:05<00:12, 1118.43it/s]Processing spectra:  39%|███▉      | 9182/23481 [00:05<00:11, 1267.12it/s]Processing spectra:  40%|███▉      | 9356/23481 [00:06<00:10, 1384.01it/s]Processing spectra:  41%|████      | 9644/23481 [00:06<00:07, 1774.21it/s]Processing spectra:  42%|████▏     | 9837/23481 [00:06<00:10, 1284.70it/s]Processing spectra:  43%|████▎     | 9996/23481 [00:06<00:15, 889.81it/s] Processing spectra:  43%|████▎     | 10121/23481 [00:07<00:20, 660.45it/s]Processing spectra:  44%|████▎     | 10219/23481 [00:07<00:21, 617.01it/s]Processing spectra:  44%|████▍     | 10303/23481 [00:07<00:22, 575.08it/s]Processing spectra:  44%|████▍     | 10375/23481 [00:07<00:28, 457.66it/s]Processing spectra:  44%|████▍     | 10433/23481 [00:07<00:28, 461.51it/s]Processing spectra:  45%|████▍     | 10488/23481 [00:08<00:31, 408.58it/s]Processing spectra:  45%|████▍     | 10535/23481 [00:08<00:33, 388.92it/s]Processing spectra:  45%|████▌     | 10578/23481 [00:08<00:37, 345.64it/s]Processing spectra:  45%|████▌     | 10615/23481 [00:08<00:37, 342.38it/s]Processing spectra:  45%|████▌     | 10651/23481 [00:08<00:41, 311.89it/s]Processing spectra:  46%|████▌     | 10684/23481 [00:08<00:46, 274.48it/s]Processing spectra:  46%|████▌     | 10713/23481 [00:09<00:53, 238.02it/s]Processing spectra:  46%|████▌     | 10745/23481 [00:09<00:50, 253.58it/s]Processing spectra:  46%|████▌     | 10772/23481 [00:09<00:52, 243.76it/s]Processing spectra:  46%|████▌     | 10801/23481 [00:09<00:51, 246.65it/s]Processing spectra:  46%|████▌     | 10849/23481 [00:09<00:42, 298.02it/s]Processing spectra:  46%|████▋     | 10881/23481 [00:09<00:43, 287.20it/s]Processing spectra:  47%|████▋     | 10922/23481 [00:09<00:42, 298.08it/s]Processing spectra:  47%|████▋     | 10960/23481 [00:09<00:40, 312.76it/s]Processing spectra:  47%|████▋     | 11001/23481 [00:10<00:39, 319.50it/s]Processing spectra:  47%|████▋     | 11034/23481 [00:10<00:48, 254.73it/s]Processing spectra:  47%|████▋     | 11062/23481 [00:10<00:55, 222.66it/s]Processing spectra:  47%|████▋     | 11087/23481 [00:10<01:01, 201.02it/s]Processing spectra:  47%|████▋     | 11120/23481 [00:10<00:56, 218.37it/s]Processing spectra:  48%|████▊     | 11160/23481 [00:10<00:48, 254.45it/s]Processing spectra:  48%|████▊     | 11188/23481 [00:10<00:49, 247.64it/s]Processing spectra:  48%|████▊     | 11219/23481 [00:10<00:47, 260.66it/s]Processing spectra:  48%|████▊     | 11260/23481 [00:11<00:41, 293.18it/s]Processing spectra:  48%|████▊     | 11303/23481 [00:11<00:40, 301.30it/s]Processing spectra:  48%|████▊     | 11334/23481 [00:11<00:49, 245.05it/s]Processing spectra:  48%|████▊     | 11361/23481 [00:11<00:49, 242.93it/s]Processing spectra:  49%|████▊     | 11389/23481 [00:11<00:49, 243.62it/s]Processing spectra:  49%|████▊     | 11415/23481 [00:11<00:52, 228.83it/s]Processing spectra:  49%|████▉     | 11454/23481 [00:11<00:44, 268.66it/s]Processing spectra:  49%|████▉     | 11483/23481 [00:12<00:59, 201.35it/s]Processing spectra:  49%|████▉     | 11508/23481 [00:12<00:59, 202.26it/s]Processing spectra:  49%|████▉     | 11531/23481 [00:12<00:57, 208.11it/s]Processing spectra:  49%|████▉     | 11563/23481 [00:12<00:52, 227.88it/s]Processing spectra:  49%|████▉     | 11602/23481 [00:12<00:44, 268.27it/s]Processing spectra:  50%|████▉     | 11638/23481 [00:12<00:41, 284.86it/s]Processing spectra:  50%|████▉     | 11668/23481 [00:12<00:43, 272.30it/s]Processing spectra:  50%|████▉     | 11704/23481 [00:12<00:42, 277.34it/s]Processing spectra:  50%|████▉     | 11733/23481 [00:13<00:44, 261.91it/s]Processing spectra:  50%|█████     | 11766/23481 [00:13<00:42, 274.16it/s]Processing spectra:  50%|█████     | 11794/23481 [00:13<00:58, 200.07it/s]Processing spectra:  50%|█████     | 11818/23481 [00:13<00:58, 200.99it/s]Processing spectra:  50%|█████     | 11843/23481 [00:13<00:58, 197.90it/s]Processing spectra:  51%|█████     | 11867/23481 [00:13<01:00, 191.05it/s]Processing spectra:  51%|█████     | 11902/23481 [00:13<00:51, 225.94it/s]Processing spectra:  51%|█████     | 11989/23481 [00:14<00:31, 369.23it/s]Processing spectra:  51%|█████▏    | 12040/23481 [00:14<00:28, 396.14it/s]Processing spectra:  52%|█████▏    | 12096/23481 [00:14<00:27, 412.78it/s]Processing spectra:  52%|█████▏    | 12145/23481 [00:14<00:26, 421.97it/s]Processing spectra:  52%|█████▏    | 12189/23481 [00:14<00:29, 388.75it/s]Processing spectra:  52%|█████▏    | 12258/23481 [00:14<00:26, 425.37it/s]Processing spectra:  52%|█████▏    | 12306/23481 [00:14<00:25, 437.26it/s]Processing spectra:  53%|█████▎    | 12351/23481 [00:14<00:34, 321.23it/s]Processing spectra:  53%|█████▎    | 12408/23481 [00:15<00:33, 332.32it/s]Processing spectra:  53%|█████▎    | 12445/23481 [00:15<00:35, 306.68it/s]Processing spectra:  53%|█████▎    | 12478/23481 [00:15<00:36, 305.38it/s]Processing spectra:  53%|█████▎    | 12521/23481 [00:15<00:32, 333.45it/s]Processing spectra:  54%|█████▎    | 12565/23481 [00:15<00:31, 351.21it/s]Processing spectra:  54%|█████▍    | 12651/23481 [00:15<00:23, 466.86it/s]Processing spectra:  54%|█████▍    | 12713/23481 [00:15<00:21, 497.32it/s]Processing spectra:  54%|█████▍    | 12768/23481 [00:15<00:21, 509.53it/s]Processing spectra:  55%|█████▍    | 12838/23481 [00:16<00:18, 561.19it/s]Processing spectra:  55%|█████▍    | 12902/23481 [00:16<00:18, 582.68it/s]Processing spectra:  55%|█████▌    | 12962/23481 [00:16<00:18, 581.30it/s]Processing spectra:  55%|█████▌    | 13021/23481 [00:16<00:19, 523.25it/s]Processing spectra:  56%|█████▌    | 13123/23481 [00:16<00:15, 657.34it/s]Processing spectra:  56%|█████▌    | 13206/23481 [00:16<00:14, 704.97it/s]Processing spectra:  57%|█████▋    | 13279/23481 [00:16<00:14, 702.56it/s]Processing spectra:  57%|█████▋    | 13364/23481 [00:16<00:14, 701.13it/s]Processing spectra:  57%|█████▋    | 13436/23481 [00:16<00:14, 704.84it/s]Processing spectra:  58%|█████▊    | 13508/23481 [00:17<00:14, 689.61it/s]Processing spectra:  58%|█████▊    | 13578/23481 [00:17<00:14, 680.78it/s]Processing spectra:  58%|█████▊    | 13647/23481 [00:17<00:14, 669.27it/s]Processing spectra:  58%|█████▊    | 13727/23481 [00:17<00:13, 705.94it/s]Processing spectra:  59%|█████▉    | 13847/23481 [00:17<00:11, 827.98it/s]Processing spectra:  60%|█████▉    | 13974/23481 [00:17<00:09, 954.43it/s]Processing spectra:  60%|█████▉    | 14071/23481 [00:17<00:10, 932.80it/s]Processing spectra:  60%|██████    | 14171/23481 [00:17<00:10, 919.52it/s]Processing spectra:  61%|██████    | 14264/23481 [00:17<00:11, 822.72it/s]Processing spectra:  61%|██████    | 14349/23481 [00:18<00:11, 771.80it/s]Processing spectra:  61%|██████▏   | 14428/23481 [00:18<00:14, 642.36it/s]Processing spectra:  62%|██████▏   | 14497/23481 [00:18<00:17, 508.80it/s]Processing spectra:  62%|██████▏   | 14555/23481 [00:18<00:18, 484.67it/s]Processing spectra:  62%|██████▏   | 14608/23481 [00:18<00:18, 469.68it/s]Processing spectra:  62%|██████▏   | 14658/23481 [00:18<00:20, 433.35it/s]Processing spectra:  63%|██████▎   | 14704/23481 [00:18<00:22, 392.62it/s]Processing spectra:  63%|██████▎   | 14745/23481 [00:19<00:23, 364.83it/s]Processing spectra:  63%|██████▎   | 14797/23481 [00:19<00:23, 365.02it/s]Processing spectra:  63%|██████▎   | 14835/23481 [00:19<00:25, 338.69it/s]Processing spectra:  63%|██████▎   | 14870/23481 [00:19<00:25, 335.33it/s]Processing spectra:  63%|██████▎   | 14904/23481 [00:19<00:26, 329.50it/s]Processing spectra:  64%|██████▎   | 14969/23481 [00:19<00:23, 354.71it/s]Processing spectra:  64%|██████▍   | 15029/23481 [00:19<00:21, 390.30it/s]Processing spectra:  64%|██████▍   | 15079/23481 [00:20<00:21, 395.40it/s]Processing spectra:  65%|██████▍   | 15171/23481 [00:20<00:17, 477.76it/s]Processing spectra:  65%|██████▍   | 15255/23481 [00:20<00:15, 525.88it/s]Processing spectra:  65%|██████▌   | 15333/23481 [00:20<00:14, 559.14it/s]Processing spectra:  66%|██████▌   | 15389/23481 [00:20<00:15, 531.06it/s]Processing spectra:  66%|██████▌   | 15456/23481 [00:20<00:14, 560.29it/s]Processing spectra:  66%|██████▋   | 15565/23481 [00:20<00:11, 690.55it/s]Processing spectra:  67%|██████▋   | 15657/23481 [00:20<00:10, 717.24it/s]Processing spectra:  67%|██████▋   | 15764/23481 [00:20<00:10, 762.95it/s]Processing spectra:  68%|██████▊   | 15866/23481 [00:21<00:09, 808.25it/s]Processing spectra:  68%|██████▊   | 15956/23481 [00:21<00:09, 777.66it/s]Processing spectra:  68%|██████▊   | 16040/23481 [00:21<00:09, 785.76it/s]Processing spectra:  69%|██████▊   | 16120/23481 [00:21<00:09, 750.13it/s]Processing spectra:  69%|██████▉   | 16196/23481 [00:21<00:09, 737.40it/s]Processing spectra:  69%|██████▉   | 16270/23481 [00:21<00:13, 552.29it/s]Processing spectra:  70%|██████▉   | 16332/23481 [00:21<00:14, 497.98it/s]Processing spectra:  70%|██████▉   | 16387/23481 [00:22<00:14, 485.97it/s]Processing spectra:  70%|███████   | 16443/23481 [00:22<00:13, 502.91it/s]Processing spectra:  70%|███████   | 16497/23481 [00:22<00:14, 488.99it/s]Processing spectra:  71%|███████   | 16564/23481 [00:22<00:13, 502.89it/s]Processing spectra:  71%|███████   | 16648/23481 [00:22<00:12, 557.51it/s]Processing spectra:  71%|███████▏  | 16769/23481 [00:22<00:09, 678.32it/s]Processing spectra:  72%|███████▏  | 16840/23481 [00:22<00:09, 683.57it/s]Processing spectra:  72%|███████▏  | 16933/23481 [00:22<00:08, 736.33it/s]Processing spectra:  72%|███████▏  | 17011/23481 [00:22<00:09, 710.92it/s]Processing spectra:  73%|███████▎  | 17110/23481 [00:23<00:08, 768.08it/s]Processing spectra:  73%|███████▎  | 17188/23481 [00:23<00:08, 767.24it/s]Processing spectra:  74%|███████▎  | 17266/23481 [00:23<00:11, 529.96it/s]Processing spectra:  74%|███████▍  | 17329/23481 [00:23<00:12, 490.97it/s]Processing spectra:  74%|███████▍  | 17386/23481 [00:24<00:21, 277.20it/s]Processing spectra:  74%|███████▍  | 17429/23481 [00:24<00:22, 272.68it/s]Processing spectra:  75%|███████▌  | 17659/23481 [00:24<00:09, 592.11it/s]Processing spectra:  76%|███████▌  | 17816/23481 [00:24<00:07, 732.14it/s]Processing spectra:  76%|███████▋  | 17935/23481 [00:26<00:27, 204.71it/s]Processing spectra:  77%|███████▋  | 18010/23481 [00:31<01:39, 55.21it/s] Processing spectra:  77%|███████▋  | 18137/23481 [00:31<01:06, 80.87it/s]Processing spectra:  78%|███████▊  | 18210/23481 [00:31<00:54, 97.23it/s]Processing spectra:  78%|███████▊  | 18273/23481 [00:31<00:45, 113.90it/s]Processing spectra:  78%|███████▊  | 18335/23481 [00:31<00:36, 139.83it/s]Processing spectra:  78%|███████▊  | 18391/23481 [00:32<00:31, 160.33it/s]Processing spectra:  79%|███████▊  | 18440/23481 [00:35<01:34, 53.20it/s] Processing spectra:  79%|███████▊  | 18475/23481 [00:36<01:56, 42.95it/s]Processing spectra:  79%|███████▉  | 18500/23481 [00:37<02:15, 36.84it/s]Processing spectra:  79%|███████▉  | 18519/23481 [00:37<01:58, 41.74it/s]Processing spectra:  79%|███████▉  | 18605/23481 [00:38<01:03, 76.72it/s]Processing spectra:  79%|███████▉  | 18638/23481 [00:39<01:21, 59.76it/s]Processing spectra:  79%|███████▉  | 18662/23481 [00:40<01:41, 47.54it/s]Processing spectra:  80%|███████▉  | 18686/23481 [00:40<01:25, 56.34it/s]Processing spectra:  80%|███████▉  | 18705/23481 [00:40<01:18, 60.83it/s]Processing spectra:  80%|███████▉  | 18721/23481 [00:40<01:20, 58.96it/s]Processing spectra:  80%|███████▉  | 18734/23481 [00:40<01:22, 57.39it/s]Processing spectra:  80%|███████▉  | 18745/23481 [00:41<01:33, 50.49it/s]Processing spectra:  80%|███████▉  | 18754/23481 [00:41<01:37, 48.33it/s]Processing spectra:  80%|███████▉  | 18761/23481 [00:41<01:44, 45.07it/s]Processing spectra:  80%|███████▉  | 18767/23481 [00:41<01:41, 46.43it/s]Processing spectra:  80%|███████▉  | 18773/23481 [00:41<01:40, 46.91it/s]Processing spectra:  80%|███████▉  | 18779/23481 [00:42<01:37, 48.39it/s]Processing spectra:  80%|████████  | 18787/23481 [00:42<01:29, 52.24it/s]Processing spectra:  80%|████████  | 18795/23481 [00:42<01:21, 57.41it/s]Processing spectra:  80%|████████  | 18802/23481 [00:42<01:24, 55.41it/s]Processing spectra:  80%|████████  | 18808/23481 [00:42<01:59, 39.02it/s]Processing spectra:  80%|████████  | 18813/23481 [00:42<02:13, 34.95it/s]Processing spectra:  80%|████████  | 18818/23481 [00:43<02:12, 35.13it/s]Processing spectra:  80%|████████  | 18824/23481 [00:43<02:12, 35.08it/s]Processing spectra:  80%|████████  | 18831/23481 [00:43<02:13, 34.77it/s]Processing spectra:  80%|████████  | 18837/23481 [00:43<02:11, 35.28it/s]Processing spectra:  80%|████████  | 18843/23481 [00:43<01:56, 39.75it/s]Processing spectra:  80%|████████  | 18848/23481 [00:43<01:57, 39.57it/s]Processing spectra:  80%|████████  | 18858/23481 [00:43<01:32, 50.08it/s]Processing spectra:  80%|████████  | 18866/23481 [00:44<01:22, 55.74it/s]Processing spectra:  80%|████████  | 18882/23481 [00:44<01:03, 72.12it/s]Processing spectra:  80%|████████  | 18890/23481 [00:44<01:06, 68.78it/s]Processing spectra:  80%|████████  | 18897/23481 [00:44<01:31, 50.07it/s]Processing spectra:  81%|████████  | 18904/23481 [00:44<01:29, 51.14it/s]Processing spectra:  81%|████████  | 18910/23481 [00:45<02:08, 35.48it/s]Processing spectra:  81%|████████  | 18915/23481 [00:45<02:16, 33.41it/s]Processing spectra:  81%|████████  | 18919/23481 [00:45<02:33, 29.80it/s]Processing spectra:  81%|████████  | 18923/23481 [00:45<02:46, 27.38it/s]Processing spectra:  81%|████████  | 18927/23481 [00:45<02:39, 28.57it/s]Processing spectra:  81%|████████  | 18931/23481 [00:45<02:43, 27.87it/s]Processing spectra:  81%|████████  | 18936/23481 [00:46<02:42, 28.04it/s]Processing spectra:  81%|████████  | 18941/23481 [00:46<02:28, 30.62it/s]Processing spectra:  81%|████████  | 18945/23481 [00:46<02:30, 30.12it/s]Processing spectra:  81%|████████  | 18949/23481 [00:46<02:55, 25.81it/s]Processing spectra:  81%|████████  | 18954/23481 [00:46<02:39, 28.44it/s]Processing spectra:  81%|████████  | 18957/23481 [00:46<03:22, 22.29it/s]Processing spectra:  81%|████████  | 18963/23481 [00:47<02:40, 28.23it/s]Processing spectra:  81%|████████  | 18967/23481 [00:47<03:30, 21.42it/s]Processing spectra:  81%|████████  | 18971/23481 [00:47<03:09, 23.84it/s]Processing spectra:  81%|████████  | 18981/23481 [00:47<01:57, 38.37it/s]Processing spectra:  81%|████████  | 18986/23481 [00:47<02:22, 31.49it/s]Processing spectra:  81%|████████  | 18991/23481 [00:48<02:22, 31.49it/s]Processing spectra:  81%|████████  | 18995/23481 [00:48<02:34, 28.95it/s]Processing spectra:  81%|████████  | 19002/23481 [00:48<02:23, 31.15it/s]Processing spectra:  81%|████████  | 19006/23481 [00:48<02:55, 25.57it/s]Processing spectra:  81%|████████  | 19013/23481 [00:48<02:14, 33.16it/s]Processing spectra:  81%|████████  | 19018/23481 [00:48<02:24, 30.94it/s]Processing spectra:  81%|████████  | 19022/23481 [00:49<02:33, 29.07it/s]Processing spectra:  81%|████████  | 19029/23481 [00:49<02:00, 37.06it/s]Processing spectra:  81%|████████  | 19035/23481 [00:49<01:53, 39.33it/s]Processing spectra:  81%|████████  | 19040/23481 [00:49<02:04, 35.75it/s]Processing spectra:  81%|████████  | 19044/23481 [00:49<02:18, 31.95it/s]Processing spectra:  81%|████████  | 19051/23481 [00:49<01:55, 38.35it/s]Processing spectra:  81%|████████  | 19059/23481 [00:49<01:43, 42.62it/s]Processing spectra:  81%|████████  | 19064/23481 [00:50<01:42, 43.29it/s]Processing spectra:  81%|████████  | 19070/23481 [00:50<01:33, 47.06it/s]Processing spectra:  81%|████████  | 19075/23481 [00:50<01:37, 45.40it/s]Processing spectra:  81%|████████▏ | 19080/23481 [00:50<02:13, 32.90it/s]Processing spectra:  81%|████████▏ | 19084/23481 [00:50<02:44, 26.80it/s]Processing spectra:  81%|████████▏ | 19094/23481 [00:50<01:52, 38.86it/s]Processing spectra:  81%|████████▏ | 19099/23481 [00:51<01:47, 40.74it/s]Processing spectra:  81%|████████▏ | 19104/23481 [00:51<02:04, 35.09it/s]Processing spectra:  81%|████████▏ | 19112/23481 [00:51<01:40, 43.61it/s]Processing spectra:  81%|████████▏ | 19118/23481 [00:51<01:49, 39.71it/s]Processing spectra:  81%|████████▏ | 19123/23481 [00:51<02:10, 33.41it/s]Processing spectra:  81%|████████▏ | 19127/23481 [00:51<02:07, 34.12it/s]Processing spectra:  81%|████████▏ | 19131/23481 [00:51<02:13, 32.60it/s]Processing spectra:  81%|████████▏ | 19136/23481 [00:52<02:02, 35.43it/s]Processing spectra:  82%|████████▏ | 19141/23481 [00:52<02:09, 33.56it/s]Processing spectra:  82%|████████▏ | 19147/23481 [00:52<02:21, 30.59it/s]Processing spectra:  82%|████████▏ | 19152/23481 [00:52<02:09, 33.38it/s]Processing spectra:  82%|████████▏ | 19158/23481 [00:52<01:55, 37.35it/s]Processing spectra:  82%|████████▏ | 19162/23481 [00:52<01:58, 36.51it/s]Processing spectra:  82%|████████▏ | 19167/23481 [00:53<02:18, 31.17it/s]Processing spectra:  82%|████████▏ | 19172/23481 [00:53<02:03, 34.99it/s]Processing spectra:  82%|████████▏ | 19179/23481 [00:53<01:47, 40.20it/s]Processing spectra:  82%|████████▏ | 19184/23481 [00:53<02:14, 31.87it/s]Processing spectra:  82%|████████▏ | 19188/23481 [00:53<02:18, 30.89it/s]Processing spectra:  82%|████████▏ | 19192/23481 [00:53<02:17, 31.12it/s]Processing spectra:  82%|████████▏ | 19196/23481 [00:53<02:23, 29.85it/s]Processing spectra:  82%|████████▏ | 19200/23481 [00:54<03:03, 23.27it/s]Processing spectra:  82%|████████▏ | 19207/23481 [00:54<02:27, 29.07it/s]Processing spectra:  82%|████████▏ | 19213/23481 [00:54<02:01, 35.02it/s]Processing spectra:  82%|████████▏ | 19218/23481 [00:54<02:19, 30.61it/s]Processing spectra:  82%|████████▏ | 19223/23481 [00:54<02:09, 32.84it/s]Processing spectra:  82%|████████▏ | 19227/23481 [00:54<02:06, 33.54it/s]Processing spectra:  82%|████████▏ | 19235/23481 [00:55<01:51, 38.09it/s]Processing spectra:  82%|████████▏ | 19239/23481 [00:55<01:55, 36.69it/s]Processing spectra:  82%|████████▏ | 19243/23481 [00:55<01:54, 37.10it/s]Processing spectra:  82%|████████▏ | 19251/23481 [00:55<01:29, 47.17it/s]Processing spectra:  82%|████████▏ | 19261/23481 [00:55<01:09, 60.74it/s]Processing spectra:  82%|████████▏ | 19285/23481 [00:55<00:40, 102.72it/s]Processing spectra:  82%|████████▏ | 19305/23481 [00:55<00:32, 128.48it/s]Processing spectra:  82%|████████▏ | 19319/23481 [00:55<00:31, 130.68it/s]Processing spectra:  82%|████████▏ | 19349/23481 [00:55<00:23, 176.67it/s]Processing spectra:  83%|████████▎ | 19376/23481 [00:56<00:20, 199.94it/s]Processing spectra:  83%|████████▎ | 19397/23481 [00:56<00:23, 174.08it/s]Processing spectra:  83%|████████▎ | 19416/23481 [00:56<00:26, 153.74it/s]Processing spectra:  83%|████████▎ | 19433/23481 [00:56<00:37, 107.94it/s]Processing spectra:  83%|████████▎ | 19447/23481 [00:57<01:00, 66.14it/s] Processing spectra:  83%|████████▎ | 19458/23481 [00:57<01:10, 57.21it/s]Processing spectra:  83%|████████▎ | 19467/23481 [00:57<01:10, 56.67it/s]Processing spectra:  83%|████████▎ | 19475/23481 [00:57<01:18, 51.33it/s]Processing spectra:  83%|████████▎ | 19482/23481 [00:58<01:41, 39.53it/s]Processing spectra:  83%|████████▎ | 19489/23481 [00:58<01:34, 42.20it/s]Processing spectra:  83%|████████▎ | 19495/23481 [00:58<01:36, 41.15it/s]Processing spectra:  83%|████████▎ | 19500/23481 [00:58<02:04, 32.00it/s]Processing spectra:  83%|████████▎ | 19504/23481 [00:58<02:18, 28.72it/s]Processing spectra:  83%|████████▎ | 19509/23481 [00:59<02:08, 30.99it/s]Processing spectra:  83%|████████▎ | 19514/23481 [00:59<01:55, 34.38it/s]Processing spectra:  83%|████████▎ | 19519/23481 [00:59<02:11, 30.13it/s]Processing spectra:  83%|████████▎ | 19529/23481 [00:59<01:33, 42.44it/s]Processing spectra:  83%|████████▎ | 19535/23481 [00:59<01:37, 40.66it/s]Processing spectra:  83%|████████▎ | 19540/23481 [00:59<01:36, 40.66it/s]Processing spectra:  83%|████████▎ | 19546/23481 [00:59<01:34, 41.48it/s]Processing spectra:  83%|████████▎ | 19556/23481 [01:00<01:16, 51.38it/s]Processing spectra:  83%|████████▎ | 19564/23481 [01:00<01:07, 57.97it/s]Processing spectra:  83%|████████▎ | 19571/23481 [01:00<01:10, 55.64it/s]Processing spectra:  83%|████████▎ | 19579/23481 [01:00<01:03, 61.54it/s]Processing spectra:  83%|████████▎ | 19586/23481 [01:00<01:10, 55.11it/s]Processing spectra:  83%|████████▎ | 19593/23481 [01:00<01:07, 57.18it/s]Processing spectra:  83%|████████▎ | 19606/23481 [01:00<00:51, 74.95it/s]Processing spectra:  84%|████████▎ | 19616/23481 [01:00<00:49, 78.76it/s]Processing spectra:  84%|████████▎ | 19625/23481 [01:00<00:48, 79.15it/s]Processing spectra:  84%|████████▎ | 19634/23481 [01:01<00:47, 81.84it/s]Processing spectra:  84%|████████▎ | 19646/23481 [01:01<00:44, 85.59it/s]Processing spectra:  84%|████████▎ | 19655/23481 [01:01<00:48, 79.54it/s]Processing spectra:  84%|████████▎ | 19664/23481 [01:01<00:57, 66.13it/s]Processing spectra:  84%|████████▍ | 19673/23481 [01:01<00:55, 68.13it/s]Processing spectra:  84%|████████▍ | 19684/23481 [01:01<00:51, 73.11it/s]Processing spectra:  84%|████████▍ | 19695/23481 [01:01<00:51, 74.00it/s]Processing spectra:  84%|████████▍ | 19703/23481 [01:02<00:52, 72.30it/s]Processing spectra:  84%|████████▍ | 19711/23481 [01:02<00:54, 69.47it/s]Processing spectra:  84%|████████▍ | 19719/23481 [01:02<01:00, 62.65it/s]Processing spectra:  84%|████████▍ | 19726/23481 [01:02<01:02, 60.33it/s]Processing spectra:  84%|████████▍ | 19737/23481 [01:02<00:55, 67.22it/s]Processing spectra:  84%|████████▍ | 19744/23481 [01:02<01:06, 56.47it/s]Processing spectra:  84%|████████▍ | 19752/23481 [01:02<01:02, 59.86it/s]Processing spectra:  84%|████████▍ | 19760/23481 [01:03<01:03, 58.43it/s]Processing spectra:  84%|████████▍ | 19770/23481 [01:03<00:54, 67.98it/s]Processing spectra:  84%|████████▍ | 19778/23481 [01:03<00:54, 68.35it/s]Processing spectra:  84%|████████▍ | 19790/23481 [01:03<00:45, 80.64it/s]Processing spectra:  84%|████████▍ | 19799/23481 [01:03<00:59, 62.24it/s]Processing spectra:  84%|████████▍ | 19807/23481 [01:03<00:58, 62.39it/s]Processing spectra:  84%|████████▍ | 19814/23481 [01:03<01:09, 52.59it/s]Processing spectra:  84%|████████▍ | 19820/23481 [01:04<01:11, 51.38it/s]Processing spectra:  84%|████████▍ | 19826/23481 [01:04<01:28, 41.15it/s]Processing spectra:  84%|████████▍ | 19834/23481 [01:04<01:18, 46.24it/s]Processing spectra:  84%|████████▍ | 19840/23481 [01:04<01:27, 41.52it/s]Processing spectra:  85%|████████▍ | 19845/23481 [01:04<01:27, 41.60it/s]Processing spectra:  85%|████████▍ | 19850/23481 [01:04<01:29, 40.79it/s]Processing spectra:  85%|████████▍ | 19858/23481 [01:04<01:17, 46.50it/s]Processing spectra:  85%|████████▍ | 19864/23481 [01:05<01:17, 46.79it/s]Processing spectra:  85%|████████▍ | 19872/23481 [01:05<01:06, 54.17it/s]Processing spectra:  85%|████████▍ | 19879/23481 [01:05<01:02, 57.65it/s]Processing spectra:  85%|████████▍ | 19885/23481 [01:05<01:05, 55.25it/s]Processing spectra:  85%|████████▍ | 19897/23481 [01:05<00:50, 71.31it/s]Processing spectra:  85%|████████▍ | 19907/23481 [01:05<00:48, 74.27it/s]Processing spectra:  85%|████████▍ | 19919/23481 [01:05<00:43, 82.37it/s]Processing spectra:  85%|████████▍ | 19931/23481 [01:05<00:39, 90.12it/s]Processing spectra:  85%|████████▍ | 19942/23481 [01:06<00:41, 86.14it/s]Processing spectra:  85%|████████▍ | 19951/23481 [01:06<00:47, 73.75it/s]Processing spectra:  85%|████████▌ | 19960/23481 [01:06<00:46, 76.01it/s]Processing spectra:  85%|████████▌ | 19968/23481 [01:06<00:51, 68.41it/s]Processing spectra:  85%|████████▌ | 19976/23481 [01:06<01:07, 52.00it/s]Processing spectra:  85%|████████▌ | 19982/23481 [01:06<01:11, 49.03it/s]Processing spectra:  85%|████████▌ | 20001/23481 [01:06<00:46, 75.19it/s]Processing spectra:  85%|████████▌ | 20018/23481 [01:07<00:37, 92.84it/s]Processing spectra:  85%|████████▌ | 20031/23481 [01:07<00:34, 101.05it/s]Processing spectra:  85%|████████▌ | 20049/23481 [01:07<00:28, 118.51it/s]Processing spectra:  85%|████████▌ | 20062/23481 [01:07<00:34, 100.44it/s]Processing spectra:  85%|████████▌ | 20074/23481 [01:07<00:34, 99.89it/s] Processing spectra:  86%|████████▌ | 20085/23481 [01:07<00:36, 94.09it/s]Processing spectra:  86%|████████▌ | 20095/23481 [01:07<00:37, 89.38it/s]Processing spectra:  86%|████████▌ | 20108/23481 [01:07<00:34, 99.00it/s]Processing spectra:  86%|████████▌ | 20120/23481 [01:08<00:32, 103.22it/s]Processing spectra:  86%|████████▌ | 20131/23481 [01:08<00:33, 99.63it/s] Processing spectra:  87%|████████▋ | 20410/23481 [01:08<00:03, 772.36it/s]Processing spectra:  87%|████████▋ | 20487/23481 [01:08<00:08, 337.73it/s]Processing spectra:  87%|████████▋ | 20545/23481 [01:09<00:11, 246.17it/s]Processing spectra:  88%|████████▊ | 20590/23481 [01:09<00:13, 211.70it/s]Processing spectra:  88%|████████▊ | 20625/23481 [01:10<00:15, 182.34it/s]Processing spectra:  88%|████████▊ | 20653/23481 [01:10<00:18, 152.46it/s]Processing spectra:  88%|████████▊ | 20676/23481 [01:10<00:20, 139.91it/s]Processing spectra:  88%|████████▊ | 20695/23481 [01:10<00:21, 131.20it/s]Processing spectra:  88%|████████▊ | 20711/23481 [01:11<00:25, 109.16it/s]Processing spectra:  88%|████████▊ | 20724/23481 [01:11<00:35, 77.64it/s] Processing spectra:  88%|████████▊ | 20737/23481 [01:11<00:34, 80.58it/s]Processing spectra:  88%|████████▊ | 20747/23481 [01:11<00:33, 81.31it/s]Processing spectra:  88%|████████▊ | 20757/23481 [01:11<00:32, 83.75it/s]Processing spectra:  88%|████████▊ | 20767/23481 [01:11<00:35, 75.79it/s]Processing spectra:  88%|████████▊ | 20776/23481 [01:12<00:36, 73.49it/s]Processing spectra:  89%|████████▊ | 20784/23481 [01:12<00:38, 69.53it/s]Processing spectra:  89%|████████▊ | 20795/23481 [01:12<00:35, 76.52it/s]Processing spectra:  89%|████████▊ | 20807/23481 [01:12<00:30, 86.34it/s]Processing spectra:  89%|████████▊ | 20818/23481 [01:12<00:30, 87.15it/s]Processing spectra:  89%|████████▊ | 20834/23481 [01:12<00:25, 103.44it/s]Processing spectra:  89%|████████▉ | 20849/23481 [01:12<00:23, 112.43it/s]Processing spectra:  89%|████████▉ | 20864/23481 [01:12<00:21, 121.99it/s]Processing spectra:  89%|████████▉ | 20877/23481 [01:13<00:21, 119.82it/s]Processing spectra:  89%|████████▉ | 20890/23481 [01:13<00:23, 111.73it/s]Processing spectra:  89%|████████▉ | 20904/23481 [01:13<00:21, 119.05it/s]Processing spectra:  89%|████████▉ | 20917/23481 [01:13<00:24, 106.08it/s]Processing spectra:  89%|████████▉ | 20930/23481 [01:13<00:22, 111.56it/s]Processing spectra:  89%|████████▉ | 20942/23481 [01:13<00:24, 104.27it/s]Processing spectra:  89%|████████▉ | 20954/23481 [01:13<00:23, 106.47it/s]Processing spectra:  89%|████████▉ | 20965/23481 [01:13<00:25, 100.15it/s]Processing spectra:  89%|████████▉ | 20980/23481 [01:13<00:22, 108.81it/s]Processing spectra:  89%|████████▉ | 20993/23481 [01:14<00:24, 100.42it/s]Processing spectra:  89%|████████▉ | 21004/23481 [01:14<00:24, 100.20it/s]Processing spectra:  89%|████████▉ | 21015/23481 [01:14<00:27, 91.32it/s] Processing spectra:  90%|████████▉ | 21025/23481 [01:14<00:27, 89.22it/s]Processing spectra:  90%|████████▉ | 21035/23481 [01:14<00:29, 83.38it/s]Processing spectra:  90%|████████▉ | 21044/23481 [01:14<00:34, 70.40it/s]Processing spectra:  90%|████████▉ | 21052/23481 [01:14<00:33, 71.77it/s]Processing spectra:  90%|████████▉ | 21061/23481 [01:15<00:32, 74.94it/s]Processing spectra:  90%|████████▉ | 21080/23481 [01:15<00:23, 104.00it/s]Processing spectra:  90%|████████▉ | 21093/23481 [01:15<00:22, 106.28it/s]Processing spectra:  90%|████████▉ | 21105/23481 [01:15<00:21, 109.60it/s]Processing spectra:  90%|████████▉ | 21117/23481 [01:15<00:22, 105.69it/s]Processing spectra:  90%|████████▉ | 21128/23481 [01:15<00:22, 105.41it/s]Processing spectra:  90%|█████████ | 21149/23481 [01:15<00:17, 131.93it/s]Processing spectra:  90%|█████████ | 21163/23481 [01:15<00:19, 120.32it/s]Processing spectra:  90%|█████████ | 21177/23481 [01:15<00:18, 122.14it/s]Processing spectra:  90%|█████████ | 21190/23481 [01:16<00:19, 120.01it/s]Processing spectra:  90%|█████████ | 21206/23481 [01:16<00:17, 128.72it/s]Processing spectra:  90%|█████████ | 21220/23481 [01:16<00:18, 122.38it/s]Processing spectra:  90%|█████████ | 21233/23481 [01:16<00:18, 121.17it/s]Processing spectra:  91%|█████████ | 21254/23481 [01:16<00:16, 138.57it/s]Processing spectra:  91%|█████████ | 21269/23481 [01:16<00:15, 139.49it/s]Processing spectra:  91%|█████████ | 21296/23481 [01:16<00:12, 174.77it/s]Processing spectra:  91%|█████████ | 21314/23481 [01:16<00:13, 163.48it/s]Processing spectra:  91%|█████████ | 21331/23481 [01:17<00:14, 153.33it/s]Processing spectra:  91%|█████████ | 21353/23481 [01:17<00:12, 164.69it/s]Processing spectra:  91%|█████████ | 21370/23481 [01:17<00:13, 152.48it/s]Processing spectra:  91%|█████████ | 21392/23481 [01:17<00:12, 167.51it/s]Processing spectra:  91%|█████████ | 21411/23481 [01:17<00:12, 171.16it/s]Processing spectra:  91%|█████████▏| 21435/23481 [01:17<00:10, 187.36it/s]Processing spectra:  91%|█████████▏| 21456/23481 [01:17<00:10, 193.28it/s]Processing spectra:  91%|█████████▏| 21476/23481 [01:17<00:10, 191.45it/s]Processing spectra:  92%|█████████▏| 21501/23481 [01:17<00:09, 207.70it/s]Processing spectra:  92%|█████████▏| 21522/23481 [01:18<00:10, 187.85it/s]Processing spectra:  92%|█████████▏| 21550/23481 [01:18<00:09, 212.66it/s]Processing spectra:  92%|█████████▏| 21578/23481 [01:18<00:08, 224.97it/s]Processing spectra:  92%|█████████▏| 21601/23481 [01:18<00:08, 225.82it/s]Processing spectra:  92%|█████████▏| 21624/23481 [01:18<00:08, 221.67it/s]Processing spectra:  93%|█████████▎| 21734/23481 [01:18<00:03, 470.52it/s]Processing spectra:  93%|█████████▎| 21884/23481 [01:18<00:02, 766.32it/s]Processing spectra:  94%|█████████▍| 22021/23481 [01:18<00:01, 942.20it/s]Processing spectra:  94%|█████████▍| 22118/23481 [01:19<00:02, 569.97it/s]Processing spectra:  95%|█████████▍| 22197/23481 [01:19<00:02, 613.89it/s]Processing spectra:  95%|█████████▌| 22321/23481 [01:19<00:01, 752.41it/s]Processing spectra:  96%|█████████▌| 22491/23481 [01:19<00:01, 981.12it/s]Processing spectra:  96%|█████████▋| 22606/23481 [01:19<00:00, 879.82it/s]Processing spectra:  97%|█████████▋| 22708/23481 [01:19<00:00, 864.92it/s]Processing spectra:  97%|█████████▋| 22804/23481 [01:19<00:00, 780.35it/s]Processing spectra:  97%|█████████▋| 22890/23481 [01:19<00:00, 767.22it/s]Processing spectra:  98%|█████████▊| 23121/23481 [01:20<00:00, 1139.72it/s]Processing spectra: 100%|██████████| 23481/23481 [01:20<00:00, 293.08it/s] 
/root/.cache/pypoetry/virtualenvs/spec2smiles-pipeline-XhsybQeG-py3.10/lib/python3.10/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
Valid samples after processing: 23424

Data split:
  Train: 18739 samples
  Val:   2342 samples
  Test:  2343 samples

Training Hybrid CNN-Transformer model...
Training Part A with Hybrid CNN-Transformer model
HybridCNNTransformer initialized with 83,103,431 parameters
  - CNN hidden: 512, Transformer dim: 512
  - Heads: 8, Layers: 6
  - Device: cuda
