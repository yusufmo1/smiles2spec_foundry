The currently activated Python version 3.12.3 is not supported by the project (>=3.10,<3.12).
Trying to find and use a compatible version. 
Using python3.11 (3.11.14)
============================================================
Training Part B (Descriptors -> SMILES)
============================================================
Dataset:    gnps
Model:      direct (DirectDecoder)
Augment:    No
Device:     cuda

Loading and preprocessing raw data...
Loaded 23481/23630 valid samples

Data split:
  Train: 18739 samples
  Val:   2342 samples

Scaling descriptors...
Preparing training data...
Building vocabulary:   0%|          | 0/18739 [00:00<?, ?it/s]Building vocabulary:   0%|          | 55/18739 [00:00<00:34, 544.98it/s]Building vocabulary:   1%|          | 217/18739 [00:00<00:15, 1173.52it/s]Building vocabulary:   2%|▏         | 395/18739 [00:00<00:12, 1446.75it/s]Building vocabulary:   3%|▎         | 580/18739 [00:00<00:11, 1605.25it/s]Building vocabulary:   4%|▍         | 751/18739 [00:00<00:10, 1642.73it/s]Building vocabulary:   5%|▍         | 919/18739 [00:00<00:10, 1652.97it/s]Building vocabulary:   6%|▌         | 1091/18739 [00:00<00:10, 1674.04it/s]Building vocabulary:   7%|▋         | 1283/18739 [00:00<00:09, 1751.45it/s]Building vocabulary:   8%|▊         | 1474/18739 [00:00<00:09, 1800.19it/s]Building vocabulary:   9%|▉         | 1667/18739 [00:01<00:09, 1838.89it/s]Building vocabulary:  10%|▉         | 1857/18739 [00:01<00:09, 1857.46it/s]Building vocabulary:  11%|█         | 2043/18739 [00:01<00:09, 1847.36it/s]Building vocabulary:  12%|█▏        | 2229/18739 [00:01<00:08, 1849.39it/s]Building vocabulary:  13%|█▎        | 2421/18739 [00:01<00:08, 1868.54it/s]Building vocabulary:  14%|█▍        | 2616/18739 [00:01<00:08, 1890.64it/s]Building vocabulary:  15%|█▌        | 2818/18739 [00:01<00:08, 1926.21it/s]Building vocabulary:  16%|█▌        | 3011/18739 [00:01<00:08, 1859.23it/s]Building vocabulary:  17%|█▋        | 3198/18739 [00:01<00:09, 1696.90it/s]Building vocabulary:  18%|█▊        | 3373/18739 [00:01<00:08, 1711.38it/s]Building vocabulary:  19%|█▉        | 3547/18739 [00:02<00:08, 1701.57it/s]Building vocabulary:  20%|█▉        | 3719/18739 [00:02<00:08, 1698.14it/s]Building vocabulary:  21%|██        | 3899/18739 [00:02<00:08, 1726.11it/s]Building vocabulary:  22%|██▏       | 4077/18739 [00:02<00:08, 1741.55it/s]Building vocabulary:  23%|██▎       | 4255/18739 [00:02<00:08, 1750.67it/s]Building vocabulary:  24%|██▎       | 4431/18739 [00:02<00:08, 1752.66it/s]Building vocabulary:  25%|██▍       | 4621/18739 [00:02<00:07, 1793.87it/s]Building vocabulary:  26%|██▌       | 4807/18739 [00:02<00:07, 1810.21it/s]Building vocabulary:  27%|██▋       | 4989/18739 [00:02<00:07, 1773.97it/s]Building vocabulary:  28%|██▊       | 5167/18739 [00:02<00:07, 1774.20it/s]Building vocabulary:  29%|██▊       | 5345/18739 [00:03<00:07, 1731.17it/s]Building vocabulary:  29%|██▉       | 5521/18739 [00:03<00:07, 1739.01it/s]Building vocabulary:  30%|███       | 5698/18739 [00:03<00:07, 1745.53it/s]Building vocabulary:  31%|███▏      | 5873/18739 [00:03<00:07, 1732.64it/s]Building vocabulary:  32%|███▏      | 6047/18739 [00:03<00:07, 1719.99it/s]Building vocabulary:  33%|███▎      | 6224/18739 [00:03<00:07, 1732.35it/s]Building vocabulary:  34%|███▍      | 6400/18739 [00:03<00:07, 1737.98it/s]Building vocabulary:  35%|███▌      | 6574/18739 [00:03<00:07, 1703.05it/s]Building vocabulary:  36%|███▌      | 6755/18739 [00:03<00:06, 1733.86it/s]Building vocabulary:  37%|███▋      | 6934/18739 [00:03<00:06, 1749.06it/s]Building vocabulary:  38%|███▊      | 7113/18739 [00:04<00:06, 1758.28it/s]Building vocabulary:  39%|███▉      | 7292/18739 [00:04<00:06, 1764.45it/s]Building vocabulary:  40%|███▉      | 7477/18739 [00:04<00:06, 1789.08it/s]Building vocabulary:  41%|████      | 7667/18739 [00:04<00:06, 1820.15it/s]Building vocabulary:  42%|████▏     | 7852/18739 [00:04<00:05, 1827.60it/s]Building vocabulary:  43%|████▎     | 8045/18739 [00:04<00:05, 1857.69it/s]Building vocabulary:  44%|████▍     | 8232/18739 [00:04<00:05, 1860.11it/s]Building vocabulary:  45%|████▍     | 8422/18739 [00:04<00:05, 1869.48it/s]Building vocabulary:  46%|████▌     | 8622/18739 [00:04<00:05, 1908.06it/s]Building vocabulary:  47%|████▋     | 8816/18739 [00:04<00:05, 1915.12it/s]Building vocabulary:  48%|████▊     | 9008/18739 [00:05<00:05, 1912.26it/s]Building vocabulary:  49%|████▉     | 9200/18739 [00:05<00:05, 1903.61it/s]Building vocabulary:  50%|█████     | 9391/18739 [00:05<00:05, 1680.31it/s]Building vocabulary:  51%|█████     | 9564/18739 [00:05<00:05, 1686.93it/s]Building vocabulary:  52%|█████▏    | 9737/18739 [00:05<00:05, 1684.70it/s]Building vocabulary:  53%|█████▎    | 9916/18739 [00:05<00:05, 1713.94it/s]Building vocabulary:  54%|█████▍    | 10096/18739 [00:05<00:04, 1734.74it/s]Building vocabulary:  55%|█████▍    | 10271/18739 [00:05<00:04, 1732.00it/s]Building vocabulary:  56%|█████▌    | 10446/18739 [00:05<00:04, 1718.90it/s]Building vocabulary:  57%|█████▋    | 10619/18739 [00:06<00:04, 1712.86it/s]Building vocabulary:  58%|█████▊    | 10795/18739 [00:06<00:04, 1725.56it/s]Building vocabulary:  59%|█████▊    | 10970/18739 [00:06<00:04, 1732.35it/s]Building vocabulary:  60%|█████▉    | 11152/18739 [00:06<00:04, 1756.54it/s]Building vocabulary:  60%|██████    | 11329/18739 [00:06<00:04, 1756.55it/s]Building vocabulary:  61%|██████▏   | 11505/18739 [00:06<00:04, 1740.73it/s]Building vocabulary:  62%|██████▏   | 11680/18739 [00:06<00:04, 1721.16it/s]Building vocabulary:  63%|██████▎   | 11853/18739 [00:06<00:04, 1708.15it/s]Building vocabulary:  64%|██████▍   | 12024/18739 [00:06<00:03, 1704.28it/s]Building vocabulary:  65%|██████▌   | 12201/18739 [00:06<00:03, 1721.47it/s]Building vocabulary:  66%|██████▌   | 12374/18739 [00:07<00:03, 1715.51it/s]Building vocabulary:  67%|██████▋   | 12558/18739 [00:07<00:03, 1752.21it/s]Building vocabulary:  68%|██████▊   | 12734/18739 [00:07<00:03, 1725.67it/s]Building vocabulary:  69%|██████▉   | 12907/18739 [00:07<00:03, 1719.44it/s]Building vocabulary:  70%|██████▉   | 13085/18739 [00:07<00:03, 1736.72it/s]Building vocabulary:  71%|███████   | 13273/18739 [00:07<00:03, 1777.31it/s]Building vocabulary:  72%|███████▏  | 13451/18739 [00:07<00:02, 1764.85it/s]Building vocabulary:  73%|███████▎  | 13628/18739 [00:07<00:02, 1748.69it/s]Building vocabulary:  74%|███████▎  | 13816/18739 [00:07<00:02, 1785.47it/s]Building vocabulary:  75%|███████▍  | 13995/18739 [00:07<00:02, 1784.61it/s]Building vocabulary:  76%|███████▌  | 14185/18739 [00:08<00:02, 1817.42it/s]Building vocabulary:  77%|███████▋  | 14369/18739 [00:08<00:02, 1821.68it/s]Building vocabulary:  78%|███████▊  | 14556/18739 [00:08<00:02, 1833.32it/s]Building vocabulary:  79%|███████▊  | 14750/18739 [00:08<00:02, 1863.88it/s]Building vocabulary:  80%|███████▉  | 14937/18739 [00:08<00:02, 1855.15it/s]Building vocabulary:  81%|████████  | 15130/18739 [00:08<00:01, 1873.91it/s]Building vocabulary:  82%|████████▏ | 15318/18739 [00:08<00:01, 1851.50it/s]Building vocabulary:  83%|████████▎ | 15504/18739 [00:08<00:01, 1832.07it/s]Building vocabulary:  84%|████████▎ | 15688/18739 [00:08<00:01, 1641.38it/s]Building vocabulary:  85%|████████▍ | 15867/18739 [00:09<00:01, 1675.49it/s]Building vocabulary:  86%|████████▌ | 16048/18739 [00:09<00:01, 1711.19it/s]Building vocabulary:  87%|████████▋ | 16223/18739 [00:09<00:01, 1721.88it/s]Building vocabulary:  88%|████████▊ | 16397/18739 [00:09<00:01, 1723.92it/s]Building vocabulary:  88%|████████▊ | 16571/18739 [00:09<00:01, 1727.74it/s]Building vocabulary:  89%|████████▉ | 16748/18739 [00:09<00:01, 1739.62it/s]Building vocabulary:  90%|█████████ | 16924/18739 [00:09<00:01, 1744.65it/s]Building vocabulary:  91%|█████████▏| 17103/18739 [00:09<00:00, 1758.10it/s]Building vocabulary:  92%|█████████▏| 17283/18739 [00:09<00:00, 1770.55it/s]Building vocabulary:  93%|█████████▎| 17463/18739 [00:09<00:00, 1778.02it/s]Building vocabulary:  94%|█████████▍| 17641/18739 [00:10<00:00, 1778.01it/s]Building vocabulary:  95%|█████████▌| 17822/18739 [00:10<00:00, 1786.10it/s]Building vocabulary:  96%|█████████▌| 18001/18739 [00:10<00:00, 1766.88it/s]Building vocabulary:  97%|█████████▋| 18180/18739 [00:10<00:00, 1772.78it/s]Building vocabulary:  98%|█████████▊| 18358/18739 [00:10<00:00, 1738.05it/s]Building vocabulary:  99%|█████████▉| 18532/18739 [00:10<00:00, 1723.28it/s]Building vocabulary: 100%|█████████▉| 18708/18739 [00:10<00:00, 1733.89it/s]Building vocabulary: 100%|██████████| 18739/18739 [00:10<00:00, 1756.02it/s]
Encoding SMILES:   0%|          | 0/18733 [00:00<?, ?it/s]Encoding SMILES:   1%|          | 165/18733 [00:00<00:11, 1648.75it/s]Encoding SMILES:   2%|▏         | 339/18733 [00:00<00:10, 1700.03it/s]Encoding SMILES:   3%|▎         | 530/18733 [00:00<00:10, 1793.20it/s]Encoding SMILES:   4%|▍         | 710/18733 [00:00<00:10, 1783.27it/s]Encoding SMILES:   5%|▍         | 893/18733 [00:00<00:09, 1787.64it/s]Encoding SMILES:   6%|▌         | 1072/18733 [00:00<00:10, 1754.24it/s]Encoding SMILES:   7%|▋         | 1264/18733 [00:00<00:09, 1804.47it/s]Encoding SMILES:   8%|▊         | 1449/18733 [00:00<00:09, 1818.04it/s]Encoding SMILES:   9%|▉         | 1645/18733 [00:00<00:09, 1860.84it/s]Encoding SMILES:  10%|▉         | 1833/18733 [00:01<00:09, 1864.73it/s]Encoding SMILES:  11%|█         | 2020/18733 [00:01<00:09, 1843.58it/s]Encoding SMILES:  12%|█▏        | 2208/18733 [00:01<00:08, 1853.22it/s]Encoding SMILES:  13%|█▎        | 2404/18733 [00:01<00:08, 1884.26it/s]Encoding SMILES:  14%|█▍        | 2596/18733 [00:01<00:08, 1893.67it/s]Encoding SMILES:  15%|█▍        | 2802/18733 [00:01<00:08, 1942.65it/s]Encoding SMILES:  16%|█▌        | 2997/18733 [00:01<00:08, 1913.25it/s]Encoding SMILES:  17%|█▋        | 3189/18733 [00:01<00:09, 1669.96it/s]Encoding SMILES:  18%|█▊        | 3366/18733 [00:01<00:09, 1696.16it/s]Encoding SMILES:  19%|█▉        | 3541/18733 [00:01<00:08, 1711.09it/s]Encoding SMILES:  20%|█▉        | 3716/18733 [00:02<00:08, 1715.95it/s]Encoding SMILES:  21%|██        | 3898/18733 [00:02<00:08, 1744.22it/s]Encoding SMILES:  22%|██▏       | 4083/18733 [00:02<00:08, 1772.35it/s]Encoding SMILES:  23%|██▎       | 4264/18733 [00:02<00:08, 1783.27it/s]Encoding SMILES:  24%|██▎       | 4444/18733 [00:02<00:08, 1755.98it/s]Encoding SMILES:  25%|██▍       | 4631/18733 [00:02<00:07, 1787.61it/s]Encoding SMILES:  26%|██▌       | 4816/18733 [00:02<00:07, 1804.37it/s]Encoding SMILES:  27%|██▋       | 4997/18733 [00:02<00:07, 1777.00it/s]Encoding SMILES:  28%|██▊       | 5179/18733 [00:02<00:07, 1787.95it/s]Encoding SMILES:  29%|██▊       | 5359/18733 [00:02<00:07, 1756.99it/s]Encoding SMILES:  30%|██▉       | 5540/18733 [00:03<00:07, 1770.93it/s]Encoding SMILES:  31%|███       | 5718/18733 [00:03<00:07, 1772.63it/s]Encoding SMILES:  31%|███▏      | 5896/18733 [00:03<00:07, 1758.47it/s]Encoding SMILES:  32%|███▏      | 6075/18733 [00:03<00:07, 1762.55it/s]Encoding SMILES:  33%|███▎      | 6255/18733 [00:03<00:07, 1772.50it/s]Encoding SMILES:  34%|███▍      | 6433/18733 [00:03<00:07, 1756.57it/s]Encoding SMILES:  35%|███▌      | 6609/18733 [00:03<00:06, 1734.91it/s]Encoding SMILES:  36%|███▋      | 6792/18733 [00:03<00:06, 1760.80it/s]Encoding SMILES:  37%|███▋      | 6970/18733 [00:03<00:06, 1762.22it/s]Encoding SMILES:  38%|███▊      | 7150/18733 [00:04<00:06, 1770.84it/s]Encoding SMILES:  39%|███▉      | 7330/18733 [00:04<00:06, 1778.68it/s]Encoding SMILES:  40%|████      | 7518/18733 [00:04<00:06, 1806.89it/s]Encoding SMILES:  41%|████      | 7703/18733 [00:04<00:06, 1818.86it/s]Encoding SMILES:  42%|████▏     | 7890/18733 [00:04<00:05, 1832.65it/s]Encoding SMILES:  43%|████▎     | 8080/18733 [00:04<00:05, 1851.76it/s]Encoding SMILES:  44%|████▍     | 8269/18733 [00:04<00:05, 1861.11it/s]Encoding SMILES:  45%|████▌     | 8463/18733 [00:04<00:05, 1883.03it/s]Encoding SMILES:  46%|████▌     | 8658/18733 [00:04<00:05, 1900.45it/s]Encoding SMILES:  47%|████▋     | 8849/18733 [00:04<00:05, 1895.36it/s]Encoding SMILES:  48%|████▊     | 9045/18733 [00:05<00:05, 1912.92it/s]Encoding SMILES:  49%|████▉     | 9237/18733 [00:05<00:04, 1901.42it/s]Encoding SMILES:  50%|█████     | 9428/18733 [00:05<00:05, 1829.47it/s]Encoding SMILES:  51%|█████▏    | 9612/18733 [00:05<00:05, 1678.13it/s]Encoding SMILES:  52%|█████▏    | 9789/18733 [00:05<00:05, 1703.37it/s]Encoding SMILES:  53%|█████▎    | 9972/18733 [00:05<00:05, 1736.79it/s]Encoding SMILES:  54%|█████▍    | 10149/18733 [00:05<00:04, 1745.84it/s]Encoding SMILES:  55%|█████▌    | 10329/18733 [00:05<00:04, 1761.00it/s]Encoding SMILES:  56%|█████▌    | 10506/18733 [00:05<00:04, 1738.18it/s]Encoding SMILES:  57%|█████▋    | 10683/18733 [00:05<00:04, 1744.46it/s]Encoding SMILES:  58%|█████▊    | 10858/18733 [00:06<00:04, 1733.53it/s]Encoding SMILES:  59%|█████▉    | 11046/18733 [00:06<00:04, 1774.22it/s]Encoding SMILES:  60%|█████▉    | 11232/18733 [00:06<00:04, 1796.35it/s]Encoding SMILES:  61%|██████    | 11412/18733 [00:06<00:04, 1784.14it/s]Encoding SMILES:  62%|██████▏   | 11591/18733 [00:06<00:04, 1754.50it/s]Encoding SMILES:  63%|██████▎   | 11769/18733 [00:06<00:03, 1760.64it/s]Encoding SMILES:  64%|██████▍   | 11946/18733 [00:06<00:03, 1747.80it/s]Encoding SMILES:  65%|██████▍   | 12121/18733 [00:06<00:03, 1715.74it/s]Encoding SMILES:  66%|██████▌   | 12304/18733 [00:06<00:03, 1747.57it/s]Encoding SMILES:  67%|██████▋   | 12484/18733 [00:06<00:03, 1760.91it/s]Encoding SMILES:  68%|██████▊   | 12661/18733 [00:07<00:03, 1759.99it/s]Encoding SMILES:  69%|██████▊   | 12838/18733 [00:07<00:03, 1745.19it/s]Encoding SMILES:  69%|██████▉   | 13018/18733 [00:07<00:03, 1759.85it/s]Encoding SMILES:  70%|███████   | 13205/18733 [00:07<00:03, 1789.21it/s]Encoding SMILES:  71%|███████▏  | 13384/18733 [00:07<00:03, 1764.40it/s]Encoding SMILES:  72%|███████▏  | 13561/18733 [00:07<00:02, 1737.76it/s]Encoding SMILES:  73%|███████▎  | 13735/18733 [00:07<00:02, 1728.48it/s]Encoding SMILES:  74%|███████▍  | 13909/18733 [00:07<00:02, 1730.83it/s]Encoding SMILES:  75%|███████▌  | 14086/18733 [00:07<00:02, 1739.82it/s]Encoding SMILES:  76%|███████▌  | 14276/18733 [00:08<00:02, 1784.35it/s]Encoding SMILES:  77%|███████▋  | 14459/18733 [00:08<00:02, 1797.76it/s]Encoding SMILES:  78%|███████▊  | 14653/18733 [00:08<00:02, 1838.36it/s]Encoding SMILES:  79%|███████▉  | 14837/18733 [00:08<00:02, 1833.82it/s]Encoding SMILES:  80%|████████  | 15024/18733 [00:08<00:02, 1843.94it/s]Encoding SMILES:  81%|████████  | 15209/18733 [00:08<00:01, 1825.63it/s]Encoding SMILES:  82%|████████▏ | 15392/18733 [00:08<00:01, 1817.11it/s]Encoding SMILES:  83%|████████▎ | 15574/18733 [00:08<00:01, 1796.36it/s]Encoding SMILES:  84%|████████▍ | 15756/18733 [00:08<00:01, 1802.30it/s]Encoding SMILES:  85%|████████▌ | 15937/18733 [00:08<00:01, 1629.70it/s]Encoding SMILES:  86%|████████▌ | 16112/18733 [00:09<00:01, 1658.53it/s]Encoding SMILES:  87%|████████▋ | 16288/18733 [00:09<00:01, 1686.56it/s]Encoding SMILES:  88%|████████▊ | 16464/18733 [00:09<00:01, 1704.15it/s]Encoding SMILES:  89%|████████▉ | 16636/18733 [00:09<00:01, 1704.05it/s]Encoding SMILES:  90%|████████▉ | 16816/18733 [00:09<00:01, 1730.54it/s]Encoding SMILES:  91%|█████████ | 16995/18733 [00:09<00:00, 1746.97it/s]Encoding SMILES:  92%|█████████▏| 17171/18733 [00:09<00:00, 1734.57it/s]Encoding SMILES:  93%|█████████▎| 17351/18733 [00:09<00:00, 1752.12it/s]Encoding SMILES:  94%|█████████▎| 17531/18733 [00:09<00:00, 1763.52it/s]Encoding SMILES:  95%|█████████▍| 17711/18733 [00:09<00:00, 1766.40it/s]Encoding SMILES:  95%|█████████▌| 17888/18733 [00:10<00:00, 1745.40it/s]Encoding SMILES:  96%|█████████▋| 18065/18733 [00:10<00:00, 1750.70it/s]Encoding SMILES:  97%|█████████▋| 18241/18733 [00:10<00:00, 1750.41it/s]Encoding SMILES:  98%|█████████▊| 18417/18733 [00:10<00:00, 1696.14it/s]Encoding SMILES:  99%|█████████▉| 18594/18733 [00:10<00:00, 1715.10it/s]Encoding SMILES: 100%|██████████| 18733/18733 [00:10<00:00, 1773.24it/s]
Valid training samples: 18733/18739
Vocabulary size: 105

Training DirectDecoder...
DirectDecoder: 17,254,505 parameters
Epoch 1: train_loss=2.7827, val_loss=2.3536
Epoch 11: train_loss=1.3143, val_loss=1.2628
Epoch 21: train_loss=1.0437, val_loss=1.0509
Epoch 31: train_loss=0.9448, val_loss=0.9958
Epoch 41: train_loss=0.8959, val_loss=0.9751
Epoch 51: train_loss=0.8658, val_loss=0.9651
Epoch 61: train_loss=0.8447, val_loss=0.9602
Epoch 71: train_loss=0.8308, val_loss=0.9571
Epoch 81: train_loss=0.8216, val_loss=0.9559
Epoch 91: train_loss=0.8172, val_loss=0.9552

Training complete!
  Final train loss: 0.8161
  Final val loss:   0.9546

Saving model to data/output/models/part_b...
Metrics saved to data/output/metrics/part_b_metrics.json

Generating visualizations...
Generating Part B visualizations...
  [OK] data/output/figures/part_b_training.png

Done!
